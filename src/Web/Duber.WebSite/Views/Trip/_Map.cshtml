<style>
    #map {
        height: 400px;
        width: 100%;
    }
</style>

<div id="map"></div>
<button type="button" onclick="test(); return;">Update current position</button>

<script>

    // TODO: refactor this ugly JS!!!

    var directionsDisplay;
    var directionsService;
    var map;
    var currentPositionMarker;
    var route;
    var directions = new Array();
    var currentPointIndex = 0;

    function initMap() {
        directionsDisplay = new google.maps.DirectionsRenderer();
        directionsService = new google.maps.DirectionsService();

        var chicago = new google.maps.LatLng(6.210292869847029, -75.57115852832794);
        var mapOptions = {
            zoom: 7,
            center: chicago
        }

        map = new google.maps.Map(document.getElementById('map'), mapOptions);
        directionsDisplay.setMap(map);
        calcRoute(map);
        updateCurrentPosition(map);
    }

    function test() {

        currentPointIndex = currentPointIndex + 20;
        var lat = directions[currentPointIndex].lat();
        var long = directions[currentPointIndex].lng();
        var currentPosition = new google.maps.LatLng(lat, long);

        currentPositionMarker.setMap(null);
        currentPositionMarker = new google.maps.Marker({
            title: "Current posistion",
            position: currentPosition,
            map: map,
            animation: google.maps.Animation.BOUNCE,
            icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png'
        });
    }

    function updateCurrentPosition(map) {
        var currentPosition = new google.maps.LatLng(6.210292869847029, -75.57115852832794);

        currentPositionMarker = new google.maps.Marker({
            position: currentPosition,
            map: map,
            title: "Current posistion",
            animation: google.maps.Animation.BOUNCE,
            icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png'
        });
    }

    function calcRoute(map) {
        var start = new google.maps.LatLng(6.210292869847029, -75.57115852832794);
        var end = new google.maps.LatLng(6.151584634798451, -75.61546325683594);

        var startMark = new google.maps.Marker({
            position: start,
            map: map,
            title: "From"
        });

        var endMark = new google.maps.Marker({
            position: end,
            map: map,
            title: "To"
        });

        var request = {
            origin: start,
            destination: end,
            travelMode: 'DRIVING'
        };

        directionsService.route(request, function (response, status) {
            if (status === 'OK') {
                directionsDisplay.setDirections(response);
                route = directionsDisplay.getDirections();
                getDirections();
            } else {
                alert("directions request failed, status=" + status);
            }
        });
    }

    function getDirections() {
        route = route.routes[0];
        var legs = route.legs;
        for (i = 0; i < legs.length; i++) {
            var steps = legs[i].steps;
            for (j = 0; j < steps.length; j++) {
                var nextSegment = steps[j].path;
                for (k = 0; k < nextSegment.length; k++) {
                    directions.push(nextSegment[k]);
                }
            }
        }
    }

</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAQQcYW1z-T_TirZEcyXOU1AK-i_vGw-SE&callback=initMap">
</script>